---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import SectionReveal from './SectionReveal.astro';
import CTAButton from './CTAButton.astro';

interface Props {
  id?: string;
  imageSrc: ImageMetadata;
  imageAlt: string;
  title: string;
  description: string;
  ctaHref: string;
}

const { id, imageSrc, imageAlt, title, description, ctaHref } = Astro.props;
---

<section
  id={id}
  aria-labelledby="heading-elena-a"
  class="bg-creme sa-section-padding"
>
  <p class="text-center text-warm-gray font-sans text-sm uppercase tracking-widest mb-8">
    Option A — Strates colorées Rainbow Mountain
  </p>
  <div
    class="max-w-6xl mx-auto flex flex-col items-center text-center lg:flex-row lg:items-center lg:text-left lg:gap-16"
  >
    <div class="lg:w-2/5">
      <SectionReveal animation="scale-in">
        <div class="elena-a__photo-wrapper">
          <div class="elena-a__stripes" aria-hidden="true">
            <span class="elena-a__stripe elena-a__stripe--1"></span>
            <span class="elena-a__stripe elena-a__stripe--2"></span>
            <span class="elena-a__stripe elena-a__stripe--3"></span>
            <span class="elena-a__stripe elena-a__stripe--4"></span>
            <span class="elena-a__stripe elena-a__stripe--5"></span>
          </div>
          <Image
            src={imageSrc}
            alt={imageAlt}
            widths={[250, 400, 600]}
            sizes="(min-width: 1024px) 40vw, 250px"
            loading="lazy"
            decoding="async"
            class="elena-a__photo"
          />
        </div>
      </SectionReveal>
    </div>
    <div class="lg:w-3/5">
      <SectionReveal animation="fade-in" delay={200}>
        <div class="mt-8 lg:mt-0">
          <h2
            id="heading-elena-a"
            class="font-serif text-3xl md:text-4xl text-warm-black mb-4"
          >
            {title}
          </h2>
          <p class="font-sans text-warm-black/90 text-lg leading-relaxed mb-8">
            {description}
          </p>
          <CTAButton
            href={ctaHref}
            variant="solid"
            size="small"
            subtext=""
            desktopOnly={true}
          />
        </div>
      </SectionReveal>
    </div>
  </div>
</section>

<style>
  .elena-a__photo-wrapper {
    position: relative;
    width: fit-content;
    margin: 0 auto;
  }

  @media (min-width: 1024px) {
    .elena-a__photo-wrapper {
      margin: 0;
    }
  }

  .elena-a__photo {
    position: relative;
    z-index: 2;
    width: 250px;
    height: 250px;
    object-fit: cover;
    border-radius: 1rem;
  }

  @media (min-width: 768px) {
    .elena-a__photo {
      width: 350px;
      height: 350px;
    }
  }

  @media (min-width: 1024px) {
    .elena-a__photo {
      width: 100%;
      height: auto;
      aspect-ratio: 4 / 5;
    }
  }

  .elena-a__stripes {
    position: absolute;
    inset: -12px;
    z-index: 1;
    overflow: hidden;
    border-radius: 1.25rem;
  }

  .elena-a__stripe {
    position: absolute;
    left: -20%;
    width: 140%;
    height: 28%;
    transform: rotate(-12deg);
    opacity: 0.6;
    border-radius: 4px;
  }

  .elena-a__stripe--1 {
    top: -4%;
    background-color: var(--color-terracotta);
  }

  .elena-a__stripe--2 {
    top: 18%;
    background-color: var(--color-ambre);
  }

  .elena-a__stripe--3 {
    top: 40%;
    background-color: var(--color-sauge);
  }

  .elena-a__stripe--4 {
    top: 62%;
    background-color: var(--color-terracotta-muted);
  }

  .elena-a__stripe--5 {
    top: 82%;
    background-color: var(--color-warm-gray);
    opacity: 0.4;
  }
</style>

<script>
  import { gsap } from '../lib/gsap';

  function initElenaA() {
    const stripes = document.querySelectorAll('.elena-a__stripe');
    if (!stripes.length) return;

    gsap.set(stripes, { xPercent: -110 });

    gsap.to(stripes, {
      xPercent: 0,
      duration: 0.8,
      ease: 'power2.out',
      stagger: 0.12,
      scrollTrigger: {
        trigger: '.elena-a__photo-wrapper',
        start: 'top 80%',
        once: true,
      },
    });
  }

  initElenaA();
</script>
