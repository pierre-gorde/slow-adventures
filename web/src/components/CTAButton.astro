---
interface Props {
  text?: string;
  subtext?: string;
  href: string;
  size?: 'default' | 'small';
  variant?: 'solid' | 'outline' | 'ghost';
  desktopOnly?: boolean;
}

const {
  text = 'Confie-moi ton prochain rÃªve',
  subtext = '30 min, gratuit, sans engagement',
  href,
  size = 'default',
  variant = 'solid',
  desktopOnly = false,
} = Astro.props;

const sizeClasses =
  size === 'small' ? 'px-6 py-3 text-sm' : 'px-8 py-4 text-base';

const variantClasses = {
  solid:
    'bg-terracotta text-white border-2 border-terracotta active:bg-terracotta-dark',
  outline: 'bg-transparent text-white border-2 border-white hover:bg-white/10',
  ghost:
    'bg-transparent text-terracotta border-2 border-transparent hover:bg-terracotta/10',
}[variant];

const visibilityClass = desktopOnly ? 'hidden lg:inline-block' : '';
---

<a
  href={href}
  data-calendly-trigger
  class:list={[
    'cta-btn inline-block font-sans font-semibold text-center motion-safe:hover:scale-[1.02] motion-safe:hover:shadow-[0_8px_32px_rgba(192,96,62,0.15)]',
    sizeClasses,
    variantClasses,
    visibilityClass,
  ]}
>
  {text}
  {
    subtext && (
      <span class="block text-xs font-normal mt-1 opacity-80">{subtext}</span>
    )
  }
</a>

<style>
  .cta-btn {
    border-radius: 2rem 2.8rem 2rem 2.8rem;
    animation: cta-morph 6s ease-in-out infinite alternate;
    transition: transform 0.3s, box-shadow 0.3s;
  }

  @keyframes cta-morph {
    0% {
      border-radius: 2rem 2.8rem 2rem 2.8rem;
    }
    33% {
      border-radius: 2.6rem 2rem 2.8rem 2.2rem;
    }
    66% {
      border-radius: 2.2rem 2.6rem 2rem 2.8rem;
    }
    100% {
      border-radius: 2.8rem 2.2rem 2.6rem 2rem;
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .cta-btn {
      animation: none;
      border-radius: 9999px;
    }
  }
</style>
